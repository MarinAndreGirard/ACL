\documentclass{article}
\usepackage{amsfonts}
\usepackage{braket}
\usepackage{amsmath}
\usepackage{bbm}
\usepackage{graphicx} % Required for inserting images
\usepackage[margin=2cm]{geometry} % Adjust the value of "2cm" to your desired margin size
\usepackage{subcaption}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{comment}

\begin{document}

\section{Energy non-conservation in the MW}

\subsection{Energy non-conservation in Sean Carroll's paper}
Sean carroll shows energy non-conservation by constructing a simple example, with $\mathcal{H}=\mathcal{H}_s\otimes\mathcal{H}_e$ and $\mathcal{H}_s=span\{|1\rangle,|2\rangle\}$ $\mathcal{H}_e=span\{|1\rangle,|2\rangle,|3\rangle\}$. The the Hamiltonian is constructed such that,
\begin{align}
    |\psi(0)\rangle&=(\alpha|1\rangle+\beta|2\rangle)|0\rangle\\
    |\psi(1)\rangle&=\alpha|1\rangle|1\rangle+\beta|1\rangle|2\rangle
\end{align}
as well as $|1\rangle|1\rangle$ an eigenstate with energy $E_1$ and $|2\rangle|2\rangle$ an eigenstate with energy $E_2$.

\textbf{The energy violation considered is that of the energy of the 2 branches v the energy of the world pre-branching: $\langle w_1|H|w_1\rangle=E_1$, $\langle w_2|H|w_2\rangle=E_2$, $\langle \psi(0)|H|\psi(0)\rangle=E$}

\textbf{The state considered in this simple example is one where the resultingt pointer states are 2 different energy eigenstates. (Generalization of this is the block diagonal case where the 2 pointer states are 2 different non-overlapping distributions in the total energy eigenspace.)}

\begin{comment}
He suggests an experiment, with a particle in a magnetic field ndergoing spin interaction with another particle passing by. this second particle is then measured. the idea is to start p1 in a superposition of spins (and so energies, being in a magnetic field). by interaction with the passing p2 entangle them. measure p2 collapsing p1 and making the system change from 0 (avg) to 2 worlds of +-E the spin energy in B. 

\begin{align}
    |\psi(t_0)\rangle&=(|\downarrow\rangle+|\uparrow\rangle)|e\rangle=|w_0\rangle\\
    &\rightarrow|\downarrow\rangle|e_1'\rangle+|\uparrow\rangle|e_2'\rangle=|w_1\rangle+|w_2\rangle
\end{align}
\end{comment}

\paragraph{But Sean Carroll never considers the preparation of the quantum superposition.} We see a scenario where we try to prepare a superposition of different energy eigenstates. 

\subsection{The battery pendulum}

\subsubsection{The scenario in words, Schroedinger's battery-pendulum}

An isolated system contains a radioactive isotope connected to a detector, closing the circuit between a full battery and an excitable pendulum at rest. After a while, there was 1/2 chance of a decay happening and being detected, thus causing the battery to empty by exciting the pendulum. The other chance is that nothing happens (battery full and pendulum at rest). Considering only the pendulum, we see that we have a system in a superposition of 2 states which have different energies, potentially causing 2 worlds with different energies after measurement. But considering the entangled battery, the energy of both worlds will actually be the same after measurement. World 1 = excited pendulum + empty battery. World 2 = pendulum at rest + full battery 

\subsubsection{More formally}
We take our radioactive atom as just a qubit in a superposition of state (we can prepare this via optics). Our pendulum at rest is $|\downarrow\rangle$ and excited is $|\uparrow\rangle$. The full battery is $|b_f\rangle$, the empty battery is $|b_e\rangle$. The environment outside of the box starts as $|e\rangle$.
\begin{align}
    |\psi(t_0)\rangle&=|\downarrow\rangle(|0\rangle+|1\rangle)|b_f\rangle|e\rangle\\
    |\psi(t_1)\rangle&=(|\downarrow\rangle|0\rangle|b_f\rangle+|\uparrow\rangle|1\rangle|b_e\rangle)|e\rangle\\
    |\psi(t_1)\rangle&=(|\downarrow\rangle|b_f\rangle+|\uparrow\rangle|b_e\rangle)|e\rangle\\
    |\psi(t_2)\rangle&=|\downarrow\rangle|b_f\rangle|e_1\rangle+|\uparrow\rangle|b_e\rangle|e_2\rangle
\end{align}
At $t_0$, the qubit is ready in a superposition and the battery+pendulum starts full + at rest. At time $t_1$, by interaction, the qubit has places the pendulum+battery in a superposition. We consider the qubit state as part of the battery . At $t_2$ we opened the box and decoherence caused the wavefucntion to branch, leaving 2 worlds with conserved energy.

\paragraph{Making it work.} Does adding an intermediary step allows for non-conservation?
\begin{align}
    |\psi(t_0)\rangle&=|\downarrow\rangle(|0\rangle+|1\rangle)|b_f\rangle|e\rangle\\
    |\psi(t_1)\rangle&=(|\downarrow\rangle|0\rangle|b_f\rangle+|\uparrow\rangle|1\rangle|b_e\rangle)|e\rangle\\
    |\psi(t_1)\rangle&=(|\downarrow\rangle|b_f\rangle+|\uparrow\rangle|b_e\rangle)|e\rangle\\
    |\psi(t_2')\rangle&=(|\downarrow\rangle+|\uparrow\rangle)|e'\rangle\\
    |\psi(t_3')\rangle&=|\downarrow\rangle|e_1'\rangle+|\uparrow\rangle|e_2'\rangle
\end{align}
We change things at $t_2'$ asking that the battery decoheres without branching the pendulum state such that we \textbf{recover a separable state with a superposition of pendulum energy state and a unique environment state}. Then at $t_3'$, we open the box and branch into two worlds with different energies.\\

For this to work, we need $e^{-itH_1}|b_f\rangle|e\rangle\approx e^{-itH_2}|b_e\rangle|e\rangle$, for $t\geq t_2$ even thought $\langle b_f|b_e\rangle\approx0$. Why is that a tall order? $|b_f\rangle$ and $|b_e\rangle$ are macroscopically different objects that we ask evolve to close to the same object at a later time.

\subsubsection{What unitary would allow for this?}

\begin{comment}
For simplicity, we can decompose the evoltion into bits and consider a different unitary for each, justifying that with the fact that the energies involved are higher for the first bits (faster frequencies), so we can neglect the second parts of the evolution at the beginning.

The part of the evolution creating the energy superposition woudl be interesting to find. But here we look at the potential for evolution that would allow us to re-factorize the (enlarged) environment thus getting the sean carroll state.

Starting with $|e_1'(0)\rangle=|0\rangle|b_f\rangle||e_1\rangle$ and $|e_2'(0)\rangle=|1\rangle|b_e\rangle||e_2\rangle$, we want an evolution that gives us approximately $\langle e_2'(T)||e_1'(T)\rangle\approx 1$. We consider $|0\rangle|b_e\rangle=|b_e'\rangle$ $|1\rangle|b_f\rangle=|b_f'\rangle$. Can we use the environment to act on this with a CNOT? Our environment is already in 2 states, $|e_1\rangle$ and $|e_2\rangle$, but considering a protected part of it that didn't vary $|e_1\rangle=|e_p\rangle|e_1''\rangle$ and $|e_2\rangle=|e_p\rangle|e_2''\rangle$. We can use $|e_p\rangle$ to apply a CNOT. 



    See this for CNOT unitary 
    https://quantumcomputing.stackexchange.com/questions/15403/what-hamiltonians-generate-hadamard-and-cnot-matrices
    
With the control on the left, a CNOT gate acts as,
\begin{eqnarray}
    |00\rangle\rightarrow|00\rangle\\
    |01\rangle\rightarrow|01\rangle\\
    |10\rangle\rightarrow|11\rangle\\
    |11\rangle\rightarrow|10\rangle
\end{eqnarray}
with matrix,
\begin{eqnarray}
    CNOT = \begin{pmatrix}
        1 & 0 & 0 & 0\\
        0 & 1 & 0 & 0\\
        0 & 0 & 0 & 1\\
        0 & 0 & 1 & 0
    \end{pmatrix}
\end{eqnarray}
So,
\begin{eqnarray}
    CNOT(|\rangle)
\end{eqnarray}
\end{comment}

We need a unitary that make 2 different states states converge to the same state at least approximately and for a certain time. 

The inner product of 2 states does not change in time,
\begin{eqnarray}
    U(t)|\psi_1(0)\rangle=|\psi_1(t)\rangle\\
    U(t)|\psi_2(0)\rangle=|\psi_2(t)\rangle\\
\end{eqnarray}
leads to,
\begin{eqnarray}
    \langle\psi_1(t)|\psi_2(t)\rangle&=\langle\psi_1(0)|U^{\dagger}U|\psi_2(0)\rangle\\
    &=\langle\psi_1(0)|\psi_2(0)\rangle
\end{eqnarray}

So it is impossible exactly. But we could consider $|e_1'\rangle=a_1|e''\rangle+b_1|e_{1,leftover}\rangle$ and $|e_2'\rangle=a_2|e''\rangle+b_2|e_{2,leftover}\rangle$ and try to minimize the $b_i$'s. 
We can use the fact that $|e_1'(0)\rangle$ and $|e_2'(0)\rangle$ are orthogonal, admn thus stay orthogonal for all $t$. 
Follow up on that... see notebook.

\subsection*{Eneergy conservation in the ACL model}


\subsubsection{Block diagonal form}

starts as superposition of eigenstate 0.3*4 and 0.7*8, meaning system energy of 6.8. (not total energy.) ends up as a branch with 4 and a branche with 8. 
We do see the system energ start at 6.8 for the frst schmidt and go up to 8. 
The second schmidt also starts there (copycat phenomena I think) and lowers to 4.
We see that the total energy is mainly determined by the system energy.

We consider a Hamiltonian in the block diagonal basis, 
\begin{equation}
    H=\sum_{i}|i\rangle\langle i|\otimes H^{(i)}_e
\end{equation}
where the initial state evolves into two worlds,
\begin{align}
    |\psi(0)\rangle &=(\sqrt{p_1}|1\rangle+\sqrt{p_2}|2\rangle)|e\rangle\\
    |\psi(t_{dec})\rangle&=\sqrt{p_1}|1\rangle e^{-it_{dec}H^{(1)}_e}|e\rangle+\sqrt{p_2}|2\rangle)e^{-it_{dec}H^{(2)}_e}|e\rangle=\sqrt{p_1}|w_1\rangle+\sqrt{p_2}|w_2\rangle
\end{align}
Then, $E=\langle\psi(t)|H|\psi(t)\rangle$ is conserved by the commutation of $U(t)$ and $H$. But from the perspective of both worlds, it is not,
\begin{align}
    \langle w_1|H|w_1\rangle&=\langle e|e^{+it_{dec}H^{(1)}_e}H^{(1)}_ee^{-it_{dec}H^{(1)}_e}|e\rangle=\mathcal{E}_1\\
    \langle w_2|H|w_2\rangle&=\langle e|e^{+it_{dec}H^{(2)}_e}H^{(1)}_ee^{-it_{dec}H^{(2)}_e}|e\rangle=\mathcal{E}_2\\
        \mathcal{E}&=p_1\mathcal{E}_1+p_2\mathcal{E}_2
\label{eq:ener_non_cons}
\end{align}
with $\mathcal{E}_i=\langle e|H^{(i)}_e|e\rangle$. $\mathcal{E}_i$ can be different from $\mathca{E}$, although there may be some counting arguments that show that it is likely to be $\mathca{E}$. 

Quite generally, with perfect decoherence, $|w_1\rangle$ and $|w_2\rangle$ have expression in the totale energy eigenbasis $\{E_i\}$,
\begin{eqnarray}
    |w_1\rangle =\sum_{i\in S_1}w^{(1)}_i|E_i\rangle\\
    |w_2\rangle =\sum_{i\in S_2}w^{(2)}_i|E_i\rangle
\end{eqnarray}
with $S_1$ and $S_2$ sets of indices and $S_1\bigcap S_2=0$. Then, we can see $|w^{(1)}(i)|^2=p_{w1}(i)$ and $|w^{(2)}(i)|^2=p_{w2}(i)$ as 2 non-overlapping distributions over the total eigneenergies, which determine the energy of the 2 worlds.
\begin{eqnarray}
    E_1=\sum_ip_{w1}(i)E_i\\
    E_2=\sum_ip_{w2}(i)E_i
\end{eqnarray}

Since in the bloc diagonal form $E_i\in S_1$ and $E_i\in S_2$ are fully determined by $H_e^{(1)}$ and $H_e^{(2)}$ respectively, we can choose the energies $E_1$ and $E_2$ completely arbitrarly, by constructing the Hamiltonian.

For example, here we start with a Hamiltonian and choose $E_i\in S_1$ and $E_i\in S_2$ by labeling. We can select the spectrum of each blocks. 
Then, considering $|e\rangle\sum^{n}_i|i\rangle$, we get non-conservation. 
We see this by ordering the energy eigenstates by eigenvalue block-diagonalizing by making the n first being the eigenstates of the first block, and the other the ones of the second block. 

\begin{align}
|E_1\rangle&=|1\rangle|1\rangle\\
\cdots\\
|E_n\rangle&=|1\rangle|n\rangle\\
|E_{n+1}\rangle&=|2\rangle|1\rangle\\
\cdots\\
|E_{2n}\rangle&=|2\rangle|n\rangle
\end{align}
Then, $|e\rangle=\sum_i|i\rangle$, means that $\mathcal{E}_1=\frac{1}{n}
\sum^{n}_{i=0}E_i$ and $\mathcal{E}_2=\frac{1}{n}\sum^{2n}_{i=n+1}E_i$, with $\mathcal{E}_2>\mathcal{E}_1$.

\paragraph*{We now work with $H$ as a GOE.}
For a random labeling, the spectra of each blocks will be that of a wigner semi-circle, with variance is $\nu=\frac{R^2}{4}$. With $R=2$ for a matrix with gaussian distribution $N(0,1)$, so $\nu=1$.
We define $E_i$ a random variable taken from the wigner semi-circle and take for simplicity $|e\rangle=\sum^{n}_i\frac{1}{\sqrt{n}}|i\rangle$. 
We can then define the random variable of the energy of a world with this chosen environment,
\begin{eqnarray}
    E_{world}=\sum_i^n\frac{1}{n}E_i
\end{eqnarray}
Then, the energy of the world is also just a random variable sampled from the same wigner semi-circle.

Central limit theorem! 

Let the spectra of $H^{(1)}_e$ and $H^{(2)}_e$ both be made up of $n$ samples of a wigner semi-circle distribution with $\mu=0$ and $\sigma=1$ (ie corresponding to GOE matrices of size $n$). These spectra are $E_1, ..., E_n$ and $E_1', ..., E_n'$.
Then, we define another random variable, 
\begin{eqnarray}
    E_{world}=\sum_i^n\frac{1}{n}E_i
\end{eqnarray}
Which is a uniform sample average of random variable $E_i$. 
We can also define the difference in energy between the 2 worlds, 
\begin{eqnarray}
    E_{world-diff}=\sum_i^n\frac{1}{n}(E_i-E_i')
\end{eqnarray}
The distribution for $E_i'$ is symmetric and the same as $E_i$, meaning we can re-write this as,
\begin{eqnarray}
    E_{world-diff}=\sum_i^{2n}\frac{1}{n}(E_i)
\end{eqnarray}

Then, by the central limit theorem $\mathbbm{E}(E_{world-diff})$ in the limit of large $n$ is a random variable sampled from the gaussian distribution with $\mu_{world-energy}=0$ and $\sigma_{world-energy}=\frac{\sigma}{\sqrt{2n}}$.
Thus we get that for a randomly selected labeling that gives us a block diagonal form + a uniformly distributed environment state, we get branching with difference in energy between the 2 branches protectedby the environemnt size. Specifically with mean 0 and variance $\sigma^2=\nu=\frac{1}{2n}$. The factor of $\frac{1}{2}$ came from the fact that we are comparing 2 branches.

\subsubsection{General ACL}

We start the system in a superposition of coherent states. Here the environemnt plays a bigger role where for the second schmidt state it grows, adding to the total energy of the world. 

\subsection{So what is happening?}

One might think this is a transfere of energy between worlds, but I dont think it is.
The total energy of a world does vary, but that is because the Schmidt states do not evolve unitarly, they evolve to a pointer state and then they do. During that time, they change what part of the state belongs to which Schmidt states until the correct pointer split has occurded. 

\subsubsection{What about energy conservation in branching?}

In the block diagonal we see a clear energy violation in branching. that is expected as our hamiltonian structure essentially has the system energy as a multiplicator. 

In the coherent state superposition we get energy conservation (approximately.) There is a way in which energy conservation is protected there.

\begin{figure}[h!]
  \centering
  \begin{subfigure}[b]{0.49\linewidth}
    \includegraphics[width=\linewidth]{Figures/basic_deco_pe.png}
    \label{fig:1}
    \caption{State of Schmidt 1 pre-decoherence}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\linewidth}
    \includegraphics[width=\linewidth]{Figures/basic_deco_post.png}
    \label{fig:2}
    \caption{State of Schmidt 1 post-decoherence}
  \end{subfigure}
  \caption{}
  \label{fig:dist_EI_dep}
  \caption{Freeze frame on the distribution of a Schmidt state in the energy eigenbasis of $H_I$ before and after decoherence. We see the distribution converge to that of a pointer state.}
\end{figure}


\begin{figure}
    \centering
    \includegraphics[width=0.5\linewidth]{Figures/energy_worlds_basic_deco.png}
    \caption{Energy of world 1 and 2 under basic block diagonal decoherence}
    \label{fig:enter-label}
\end{figure}

\begin{figure}[h!]
  \centering
  \begin{subfigure}[b]{0.49\linewidth}
    \includegraphics[width=\linewidth]{Figures/ACL_deco_pre.png}
    \label{fig:1}
    \caption{State of Schmidt 1 pre-decoherence}
  \end{subfigure}
  \begin{subfigure}[b]{0.49\linewidth}
    \includegraphics[width=\linewidth]{Figures/ACL_deco_post.png}
    \label{fig:2}
    \caption{State of Schmidt 1 post-decoherence}
  \end{subfigure}
  \caption{}
  \label{fig:dist_EI_dep}
  \caption{Freeze frame on the distribution of a Schmidt state in the energy eigenbasis of $H_I$ before and after decoherence. We see the distribution converge to that of a pointer state.}
\end{figure}

\begin{figure}
    \centering
    \includegraphics[width=0.5\linewidth]{Figures/energy_worlds_general_ACL.png}
    \caption{Energy of world 1 and 2 under more general ACL deocoherence}
    \label{fig:enter-label}
\end{figure}

does interteaction strenghts between system and hamiltonian dictate if energy is conserved or not? 
Does te size of the environemnt dictte the precision to which the energy is conserved?


\section{Next step/solution}

Basic questions to answer,
\begin{itemize}
    \item what initial state does Sean carroll start with and what hamiltonian is necessary to create that state. DONE
    \item IS coherence catalytic? 
    \item is cohernece conserved under a unitary operation? DONE
    \item is coherence conserved in branches? DONE
    \item How can I reconcil sean Carroll's energy violation with my thought experiment 
    \item How can I reconcile my thought experiment with the BD case.
    \item Figure out the Unitary necessary to get t0 to t1 in my thought experiment to check its possible.
    \item Could I create energy non-conservation in branching with a coherent state superposition? How much fine tunning is requiered?
    \item I can think of 2 ways in which you get energy violation: superposition of energy states of the system such that the energy difference of the system is not corrected during the measure./superposition of states such that the 2 resulting pointer states result in distributions in the total energy eigenstates that creates a violation. Is there a difference?
\end{itemize}

Solutions to explore,
\begin{itemize}
    \item The issue with the battery pendulum may be resolvable by considering a small battery. Show that system size/energy difference acts as a protection to energy non-conservation. Does the energy gap size matter in the amount of fine tunning requiered to violate energy conservation.
    \item Make clear the way that energy conservation is violated in the block diagonal case. 
    \item explore numericallhy how energy conservation is violated in more general ACL cases. Do we see energy exchange between the branches until decoherence is finished? how
    \item Explore how experimentaly energy superpositions are achieved: Jaynes Cummings model
    \item Learn about resource theory of quantum thermodynamics, see if there is a necessary ressource in creating a superposition of energy levels.
    \item Learn about coherence the "RT of superpositions" and see if it is a useful framework to study energy conservation in branching.
    \item Devellop thought: coherence not preserved under unitary (HO example). It is not conserved in branching (see ACL eig to coherent state evol.). Check this fact when considering the environment. Does that mean that coherence can be gotten out of branching? could i get energy sperpositions by decoherence? 
    \item dev though: coherence in energy eigenstates is special. And it might be important for the energy violation idea... it probably clearly does in the BD case? can we generalize to ACL?
    \item 
\end{itemize}

Questions for Andreas and Zoe:
\begin{itemize}
    \item Is it a decenty approximation to see Schmidt states evolving non-unitarly, until they become pointer states after-which they do. 
    \item Tried to obtain the result from Zurek where he gets coherence from decoherence. I do get that a position eigenstate does become a superposition of pointers, the main one a coherent state. But it oscillates back and forth... This feels like a behavior to explain...
\end{itemize}

\section{Creating a superposition of energies such that branching violates energy conservation}

\textbf{Can we create a system that when measured results in worlds with different energies?} Sean Carroll argues yes, but does not explain how to achieve the necessary initial state $|\psi\rangle=(|\downarrow\rangle+|\downarrow\rangle)|e\rangle$. 

\textbf{Can we create Sean Carroll's initial state?} Making Sean Carroll's energy superpositions is making a system in a superposition of 2 self energy eigenstates which are also pointer states of the environment.

\textbf{Can we create another system+env such that energy is violated?}

%The question is: from a state $|\psi(t_0)\rangle=|\downarrow\rangle|coherence?\rangle|battery?\rangle|e\rangle$, can I get $|\psi(t_1)\rangle=(|\uparrow\rangle+|\downarrow\rangle)|e'\rangle$, so that there is then a $t_2$ where decoherence has happened and $|\psi(t_2)\rangle=(|\uparrow\rangle|e_1'\rangle+|\downarrow\rangle|e_2'\rangle$ with energy violation in branching.

%conclusion 1: the jaynes cummings model does not allow that.
%conclusion 2: coherence is needed to create energy superpositions.
%conclusion 3: (answer to, can we use it to get energy violation?)

%Contradictions i am working with: With my block diagonal example, i can easily get 2 worlds to be energy violating. Experimentally we create systems in superpositions of energy eigenstates. In theory, without decoherence it is impossible to create a superposition of states. In theory, even with coherence, I am not sure if we can create a system in superposition of energy eigenstates, such that when considering everything, we actually have energy violation of worlds.

%Resolving the block diagonal ease of making energy violating worlds: I am starting with energy superposition?

%We cannot turn a system in a definit energy state into a system in an energy superposition. Yet we regularly creat systems in an energy superpositions in the lab.
%----
Multiple ideas/questions: 
\begin{itemize}
    \item The Jaynes-Cummings model 
    \item How to make energy superpositions and what does it mean?
    \item We dont have to create Sean Carroll's state to get energy violation.
    \item Can I take the photon in the environment without collapsing the atom state? It needs to not be a pointer state. In the thought experiment, the battery superposition needs to be a pointer state of the environment. (but even then we have energy conservation) 
    \item Small battery idea
    \item Coherence to make a superposition
    \item Look at the energy of Schmidt states during branching? ACL model.
    \item Does the Hamiltonian needed to use coherence to make a superposition allow for energy violation. Both my battery example, the JC model and the example used in the catalytic coherence paper have energy conservation.
\end{itemize}

\begin{comment}
-something about how, in the ACL model, looking at graphs that show the system and environments exchange energy, is a very clear demo that the energy structure of the system and the environment can change. (leads to question, how does the distribution in the basis of E and S change as we go to equilibrium?)
\end{comment}


\subsection{Using the Jaynes-Cummings model}
A quantum optics model describing 2 level atom interacting with photon in cavity.

The system has an atom with 2 energy levels with hamiltonian 
\begin{equation}
    H_A=E_e|e\rangle\langle e|
\end{equation}
Note that $E_g=0$ for simplicity.
There is also a photon field with, 
\begin{equation}
    H_F=\hbar\omega(aa^{\dagger})
\end{equation}
Note that we remove the constant scale factor for simplicity.
And then there is an interaction Hamiltonian, which after simplification only contains terms relating to de-excitation into a photon and excitation by absorption of a photon,.
\begin{equation}
    H_{AF}=\hbar g(\sigma^{+}a+\sigma^-a^{\dagger})
\end{equation}

We have $H_{JC}=H_A+H_F+H_{AF}$, and a bit of maths tells us, is that the energy eigenstates of this system are,
\begin{align}
    |n,+\rangle=cos(\theta_n/2)|e,n-1\rangle+sin(\theta_n/2)|g,n\rangle\\
    |n,-\rangle=cos(\theta_n/2)|g,n\rangle-sin(\theta_n/2)|e,n-1\rangle
\end{align}
where $n$ is the number of photon modes, $e$ is the excited atom state, $g$ the atom ground state. So the eigenstates of the system don't have an atom either in the ground state or in the excited state. This means that if the system starts in a state where the atom is just in the excited state, it will evolve to a superposition of excited and ground state atoms. Simply put, \textbf{The eigenstates of $H_{JC}$ are superpositions of eigenstates of $H_A$}. But we cannot create Sean Carroll's initial state, \textbf{the photon acts as the battery in the thought experiment.}\\

\subsubsection{A JC model that doesn't conserve energy?}
\textbf{The energy is conserved in branching, because the pointer states of the system have the same energy as the initial state of the system.}

If the pointer states of the environment where the energy eigenstates of the cavity, we would have energy non-conservation in branching

To do that we need the interaction between the cavity and the environment to be,
\begin{equation}
    H_{JC,env}=|g,n\rangle\langle g,n|\otimes H^{(1)}_{e}+|e,n-1\rangle\langle e,n-1|\otimes H^{(2)}_{e}
\end{equation}
as long as the $H_e$ matrices cause decoherence.

\textbf{What is the interaction of the environment and an atom? I assume it is such that the pointer states are atoms of definite energy? Why? Is it because the environment is mainly made of other atoms?}

Somehow, the JC model evolution causes us to go from 1 pointer state to 2 pointer states, but they have the same energy. Why?
the interactions between the electric field and the atom field are energy preserving. so the states that entangle together have exchanged energy, making it constant with entangled states.

--if the interaction hamiltonian doesnt commute with either self interaction hamiltonian, then we get exchange of energy between field 1 and field 2. see thermalization graph for the ACL model
--if field 1 commutes with the interaction hamiltonian, then the energy of field 1 is constant in both worlds. Can you get exchange of energy between worlds? see graphs with schmidt states

To make a similar model, just create 2 fields with a self interaction Hamiltonian each, then create an interaction Hamiltonian that doesn't commute with either. what if it commutes with one of them? do i get energy violation then?

\subsection{Making a superposition (using coherence)}
A more quantum info view. 2 papers: "Catalytic coherence" and "Is coherence catalytic?"

Making a superposition unitarly is non-trivial. For example, there is no $U$ unitary such that $U|00\rangle=\frac{1}{\sqrt{2}}|0\rangle(|0\rangle+|1\rangle)$. We can see this by attempting to construct $U$. In the $\{|00\rangle,|01\rangle,|10\rangle,|11\rangle\}$ basis, we can figure out the necessary part of $U$. (A dot is a un-specified value)
\begin{align}
    U|00\rangle=
    \begin{pmatrix}
        \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & 0 & 0\\
        \frac{1}{\sqrt{2}} & \frac{1}{\sqrt{2}} & . & .\\
        0 & . & . & .\\
        0 & . & . & .
    \end{pmatrix}
    \begin{pmatrix}
        1\\
        0\\
        0\\
        0
    \end{pmatrix}
    =
    \begin{pmatrix}
        \frac{1}{\sqrt{2}}\\
        \frac{1}{\sqrt{2}}\\
        0\\
        0
    \end{pmatrix}
\end{align}
Next we check if this matrix could be unitary,
\begin{equation}
    UU^{\dagger}=
    \begin{pmatrix}
        1 & 1 & . & .\\
        1 & . & . & .\\
        . & . & . & .\\
        . & . & . & .
    \end{pmatrix}
\end{equation}
What we find is that $U$ cannot be unitary.
Note that a unitary matrix is hermitian, which was used to fix $U_{11}$

We can find a $U$ s.t,
\begin{equation}
    U\frac{1}{\sqrt{2}}(|0\rangle+|1\rangle)|0\rangle=|0\rangle|0\rangle+|1\rangle|1\rangle
\end{equation}
This is what happens with the battery example, and this is what happens with the block diagonal branching scenario. But this has not created a superposition, it has used a superposition.

Can we find a $U$ s.t,
\begin{equation}
    U|0\rangle|0\rangle=\frac{1}{2}(|0\rangle+|1\rangle)(|0\rangle+|1\rangle)
\end{equation}
This would be like generating coherence from thin air, which I think i impossible... TODO, check

\subsubsection{Coherence}
Coherence is what is needed to creat superposition in a certain basis. Certain states are better at it than others. Coherence is basis dependent. The maximally mixed state has zero coherence, which makes sense, because how could we make a quantum superposition from a classical state (in the pointer basis)? A measure of coherence are the diagonal terms.

Basic idea: To make a superposition of states you need another superposition of states (check)


TODO: clear definition of coherence.
TODO measure of coherence.
Issue/question for all non-catlytic ressources: If our world is classical, where is the quantumness? How do we concentrate it to use in quantum computers? We mostly never create a quantum resource, then how "lasers"?) (ZOE question) I guess, a classical state might have coherence wrt to a specific basis? and that basis is used by defining and having access to weird observables? We have sources of these quantum ressources, like T-factories, and lasers for coherence...

Consider, 
\begin{equation}
    H= a^{\dagger}a
\end{equation}
with eigenstates $H|n\rangle n|n\rangle$. Then a state $\rho=\sum_{nm}\rho_{nm}|n\rangle\langle m|$ has coherence wrt to the energy eigenbasis, if it has non-zero off diagonal terms.
Note that the ground state $|0\rangle $ has no coherence, but that a coherent states $a|\alpha \rangle=\alpha|\alpha\rangle does. And importantly, that it there is a unitary that goes from one to the other, called the displacement unitary,
\begin{eqnarray}
    D(\alpha)=exp(\alpha a^{\dagger}-\alpha a)
\end{eqnarray}

\textbf{So clearly, coherence is not conserved under unitary operations.}

What about when undergoing branching? Is coherence conserved between the initial state and the branch? 
No, as counter example we have the case where coherence is created by decoherence, when we initialize the ACL state and branches end up-having coherent states. 

As detailed in "Coherent states from decoherence"

TODO use the ACL model to obtain the gain of cohrence from decoherence of Zurek. in the weak coupling limit we should get decoherent states from.

We see this in the following 2 frames of the 
%Name of the gif rho_s_first_eig_distrib_in_H_int_s_gif_strong_interaction_limit
\begin{figure}[h!]
  \centering
  \begin{subfigure}[b]{0.49\linewidth}
    \includegraphics[width=\linewidth]{Figures/pre_deco_strong_int_coherent.png}
    \label{fig:1}
    \caption{System state in the position basis initialized as a coherent state before decoherence happens} 
  \end{subfigure}
  \begin{subfigure}[b]{0.49\linewidth}
    \includegraphics[width=\linewidth]{Figures/post_deco_strong_int_not_coherent.png}
    \label{fig:2}
    \caption{System state in the position basis after decoherence, where it has become near a position eigenstate.}
  \end{subfigure}
  \label{fig:dist_EI_dep}
  \caption{}
\end{figure}
In the following we also look at obtaining coherence from decoherence. Note, we actually obtain an oscilation between coherent states and position eigenstates... how can we explain this?

\subsubsection{Coherence is non-classical + is related to entanglement}
Another intersting note on coherence, is that it is tied to entanglement. 
%https://physics.stackexchange.com/questions/204100/entanglement-and-coherence very cool post about that.

A simple way to see that coherence (superpositions) is not the same as entanglement. 
Take $|\psi\rangle=a|0\rangle+b|1\rangle$, then,
\begin{equation}
    \rho=\begin{pmatrix}
        aa^* & ab^* \\
        ba^*& bb^* \\
    \end{pmatrix}
\end{equation}
Entangle it with $|0\rangle$ using a CNOT, leading to $|\psi\rangle=a|00\rangle+b|11\rangle$, tracing out over that ancilla qubit, we get,
\begin{equation}
    \tilde{\rho}=\begin{pmatrix}
        aa^* & 0\\
        0& bb^* \\
    \end{pmatrix}
\end{equation}
consider now a simplified double slit experiment with observable $A=|1\rangle\langle 1|$. 
The time evolution of the qubit will allow for interference like in the double slit. A detector y then clicks if it transitioned from $|0\rangle$ to $|1\rangle$.  
\begin{equation}
    |0\rangle\rightarrow \alpha_0(y)|0\rangle+\f_0(y)|1\rangle\\
    |0\rangle\rightarrow \alpha_1(y)|0\rangle+\f_1(y)|1\rangle
\end{equation}
So with,
\begin{equation}
    \begin{pmatrix}
        \alpha_0 & f_0\\
        \alpha_1 & f_1
    \end{pmatrix}
\end{equation}
The measurement results $\langle A\rangle=Tr[\rho U^{dagger}AU]$, is different in both cases,
\begin{eqnarray}
    Tr[\rho U^{dagger}AU] = |af_0(y)+bf_1(y)|^2\\
    Tr[\tilde{\rho} U^{dagger}AU] = |af_0(y)|^2+|bf_1(y)|^2
\end{eqnarray}

%ressource theory = free operation
%maximally mixed state + any fee operation = set of free states
%leftover states = ressource.
\begin{comment}   
Coherences: 
For,
\begin{align}
    |\psi\rangle =a|0\rangle+be^{i\theta}|1\rangle\\
    |\psi'\rangle =e^{i\phi}(a'|0\rangle+b'e^{i\theta'}|1\rangle)\\
\end{align}
in $|\psi\rangle$ there is perfect coherence between $|0\rangle$and $|1\rangle$ (for $\theta$ well defined). Defining $|\phi\rangle=|\psi\rangle+|\phi'\rangle$, with $\theta, \theta', \phi=0$ the probabilities add up classically. But with non-zero phases, they dont. Without coherence between states (ie non-zero controlled phase relations) we loose things like entanglement that make the probabilities non-classical.
\end{comment}

\textbf{Distillable coherence} is a measure of how many maximally coherent states can be generated with a state.(maximally coherent state $\sum_{i}|i\rangle$, incoherent density matrices: $\rangle p_i|i\rangle\langle i|$)

\paragraph{Testing our simple battery example:}
The initial state is $|\psi(t_0)\rangle\frac{1}{\sqrt{2}}(|0\rangle+|1\rangle)|e'\rangle$ with $|'e\rangle=|\downarrow\rangle|b_f\rangle|e\rangle$. In the $\{|0\rangle,|1\rangle\}$ basis this state $\rho_q=Tr_e[(|0\rangle+|1\rangle)|e'\rangle(\langle0|+\langle1|)\langle e'|]$ is the maximally coherent state,
\begin{equation}
    C_d(\rho_q)=S(\Delta[\rho_q])-S(\rho_q)=1
\end{equation}
and evolving it to $|\psi(t_1)\rangle=\frac{1}{\sqrt{2}}(|0\rangle|e_0'\rangle+|1\rangle|e_1'\rangle$ with $\langle e_1'|e_0'\rangle=0$, we find that $\rho_q=\mathbbm{1}$, meaning $C_d(\rho_q)=0$ and coherence has been used up. 
\begin{comment}
\subsubsection{How is Coherence not catalytic}

It is firstly not catalytic because the state of the environment changes. It is "apparently" catlaytic because even thoght it chanegs, we can still re-use it to creat a another superposition just like the first one, and the resulting environment state is just as coherent as the initial one even if different.

But these 2 reasons why it is catalytic neglect entanglemenet. Entanglement between the env and sys but also between the qubit superpositions that are created.

In other words. what the original paper shows, is that you can use your coherent env state to creat a qubit superposition, and another and ... however many you want. So great, catalytic coherence. What the second paper shows is that this is neglecting to consider the entanglement between the qubit superpositions that is created, and that considering that, one of the low probability events can cause the coherent source to fully loose its coherence
\end{comment}

\subsubsection{How do these papers relate to my problem of studying energy violation in measurements}

In the paper, the example where coherence is used to make an energy superposition of a system still leads to energy conservation at the branch level. We then wonder if we can modify the example to lead to energy violation?

TODO quick calculation of why in the paper energy is conserved.
+ how to modify to lead to energy violation.


\subsection{Defining the Hamiltonian for it}

\subsubsection{Block diagonal case}

In the block diagonal branching case, the energy difference in both worlds is already setup. interestingly it is by difference in total energy eigenstates. in sean carroll's paper its more about a system energy being differente, the environment energy stays the same...  

The general block diagonal case is $H=H_s\otimes \mathbbm{1}+H_I+\mathbbm{1}\otimes H_e = \sum_i|i\rangle\langle i|\otimes id+\sum_i|i\rangle\langle i|\otimes H_i+\mathbbm{1}\otimes H_e$. We know that if $[H_s,H_I]=0$ can cause the environment term and the worlds to have different energies defined by the blocks $H_i$. Another way of seeing this is to look at expectation values of the initial and final states,
\begin{equation}
    (|0\rangle+|1\rangle)|e\rangle\rightarrow|0\rangle|e_0\rangle+|1\rangle|e_1\rangle
\end{equation}
Then, 
\begin{align}
    \langle H(t_0)\rangle&=\langle 0|H_s|0\rangle+\langle 0e| H_I|0e\rangle+\langle e|H_e|e\rangle\\
    \langle H(t_1)\rangle&=\langle 0|H_s|0\rangle+\langle 0e_1| H_I|0e_1\rangle+\langle e_1|H_e|e_1\rangle\\
\end{align}
Before and after decoherence $\langle 0|H_s|0\rangle$ is the same, but because of the non-commutativity of $H_I$ and $H_e$ we have that $\langle 0e| H_I|0e\rangle\neq\langle 0e_1| H_I|0e_1\rangle$. There is exchange of energy between $\langle H_I\rangle$ and $\langle H_e\rangle$, which for a very large environment does not cause any meaningfull change in $\langle H_e\rangle$. 


There is always conservation of the non-zero weights of the state in the total energy eigenbasis. there doesn't have to be at the level of worlds with the right block diagonal form. 

%Whit the right non-commutativity between interaction and self interaction terms we can also manipulate
%there is a conservation of the number of energy eigenstates with non-zero weight. but there is not conservation of the number of system eigenstaet, or environmenrt eigenstaets, I need an interactio term for that. is there something there?

\subsection{Thinking pointer states}

\textbf{Question: Why does the JC model have energy conservation then?}
Because of the pointer states of the environment. 

Conjecture: energy always seems conserved because pointer states of the environment do not change drastically? 

If we could have a system in a pointer state, make its Hamiltonian temporarily like the JC model (ie, the pointer state is no longer an energy eigenstate), then it will evolve in a superposition of pointer states of the environment, each with the same energy. Re-activating the interaction between the environment and the system woudl cause it to appear in a branch as having conserved energy. A way to not have that would be to have a different environemnt with a different.



\section*{This week's work}

I have many opened tabs: see Next steps list and talk about each of them....

\begin{itemize}
    \item Figure out the general consensus on if coherence is catalytic. To do so, re-read the 2 papers on catalytic coherence...
    \item Why do we care about coherence? Does it help me solve the issue of understanding why the environment can absorbe the superposition of pulses without branching. Does the catalycity of coherence actually matter at all for our question?
    \item Does "resource theory of thermodyanmics" contain info that is useful in our quest to understand if sean carroll is right.
\end{itemize}


\subsection*{Is it or not?}

Aberg: Yes, see my first paper


thoughts: Runnaway coherence. If coherence was catalytic, could i not make the whole universe in a certain state that is not reachable by unitary evolution? ie the near absolutely cohrence state in a choose set of basis.
issue with any resource being catalytic, the operation by which you use the ressource catalytically is a free operation, then if we can use it to make more of itself, then we can change the amount of a resource we have for free.
Note, you may not necessarly be abel to use a resource catlytically to make more of itself...

resource theory: states we can get for free. free operations. 
result: state conversion condition, ie from a state rho you know if you can make a state rho' using your free operations. this condition comes in the form of a function of the states following a certain inequality (ie majorization of rho).
confusion: Can we ever only do free operations? is it a human limitation or a physical limitation? If it is physical, i dont get how studying resource theories is different from studying unitary evolution...
clearing of confusions: the free op, dont necessarly reflect absolut limitations, but arbitrarily choosen ones.(such as just local op.)

Entanglement RT example: Alice and Bob cna actg localy and exchange information classically together (ie do classical stuff). Turns out starting from a certain class of states (classical separble states) you can never get an entangled state like that, so we identified the resource of entanglement.
Often operations we want to do usinfg resources (ie teleportation) requier a pure form, so we also study distillation of resources. 

\subsection{So why do we care about a RT of thermodynamics?} 

I think we might want to consider thermal operations only... Or to see if sean carroll's state is achievable with only TO.

"So in conclusion, in general, for TOs it remains an open question as to what are the necessary and sufficient conditions characterizing transitions between arbitrary, energy-coherent states."
from the RT of thermo paper, i think this is relevant because we might be attempting to see if sean carroll's state requier maybe some thermodynamic resource to be achieved??? 
We have this thermodynamic resource, and we have coherence. which one is necessary to achiee SC's state?

"For initial and final states which are block-diagonal, the set of allowed transitions via GPs coincide with thermal operations. However, for general quantum states, GPs may act on energy-incoherent initial states to create energycoherent final states. This is not possible via thermal operations."
!!!! So by free thermal operations, we can increase cohjerence in the energy basis? figure it out...
GP is one possible RT, a less populare one

Note that b attery is an already loaded term in RT of thermodynamics.

The battery thing is pretty related to my pendulum battery example!

coherence in the MW: Decoherence causes a loss of coherence in the pointer basis for the system. what about the environment? 
Does coherence appear conserved in branches, but it not actually in the whole universe? is there something to say about a basis being meaningfull in a branch not meaning it is meaningfull in another branch?
so we have decoherence in the pointer basis, does this somehow relate to decoherence in the energy eigenbasis? Could my study of the role of the energy eigenbasis in branching lead to saying something about how coherence in the pointer basis and coherence in the energy basis are related?


\end{document}